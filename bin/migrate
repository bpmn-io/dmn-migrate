#!/usr/bin/env node

const {
  input,
  output
} = require('mri')(process.argv, {
  alias: {
    i: 'input',
    o: 'output'
  }
});

if (!input || !output) {
  console.error('Error: Missing --input or --output');
  process.exit(1);
}

const fs = require('fs');

const diagramXML = fs.readFileSync(input, 'utf8');

const { migrateTo13: migrateDiagram } = require('../src/migrateDiagram');

migrateDiagram(diagramXML)
  .then(outputXML => {
    fs.writeFileSync(output, outputXML);
  })
  .catch(error => {
    console.error(error);
    process.exit(1);
  });